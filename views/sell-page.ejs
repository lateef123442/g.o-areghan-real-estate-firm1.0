<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sell Your Home - G.O AREGBAN REAL ESTATE FIRM and Consultant</title>
  <!-- Google Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <style>
    /* Reset and base */
    *, *::before, *::after {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
        Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      background: #f5f7fa;
      color: #222;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      scroll-behavior: smooth;
    }
    a {
      color: #1761a0;
      text-decoration: none;
      transition: color 0.3s ease;
    }
    a:hover, a:focus {
      color: #003d66;
      outline: none;
    }
    button {
      cursor: pointer;
      border: none;
      background: #1761a0;
      color: white;
      font-weight: 600;
      border-radius: 6px;
      padding: 10px 16px;
      font-size: clamp(0.9rem, 1vw + 0.3rem, 1.1rem);
      transition: background-color 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      user-select: none;
    }
    button:disabled {
      background: #a0b8cf;
      cursor: not-allowed;
    }
    button:hover:not(:disabled), button:focus-visible:not(:disabled) {
      background: #004080;
      outline: none;
    }
    input, select, textarea {
      font-family: inherit;
      font-size: clamp(0.9rem, 1vw + 0.3rem, 1rem);
      padding: 11px 14px;
      border-radius: 6px;
      border: 1.5px solid #cfdde8;
      transition: border-color 0.3s ease;
      width: 100%;
      max-width: 600px;
      box-sizing: border-box;
      color: #222;
      resize: vertical;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #1761a0;
      box-shadow: 0 0 6px #1761a0aa;
    }
    label {
      font-weight: 600;
      margin-bottom: 6px;
      display: inline-block;
      font-size: clamp(0.85rem, 1vw + 0.1rem, 0.95rem);
      color: #444;
      user-select: none;
    }
    header {
      height: 64px;
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: saturate(180%) blur(12px);
      border-bottom: 1px solid #ddd;
      display: flex;
      align-items: center;
      padding: 0 24px;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 8px rgb(0, 0, 0, 0.06);
    }
    .logo {
      font-weight: 800;
      font-size: 1.5rem;
      color: #1761a0;
      display: flex;
      align-items: center;
      gap: 8px;
      user-select: none;
    }
    .logo .material-icons {
      color: #0d3a66;
      font-size: 1.8rem;
    }
    .container {
      max-width: 900px;
      margin: 40px auto 60px;
      padding: 0 20px;
      background: white;
      border-radius: 20px;
      box-shadow: 0 8px 32px rgb(0, 0, 0, 0.08);
      padding: 40px 32px;
    }
    h1 {
      font-weight: 900;
      font-size: clamp(2rem, 5vw, 3rem);
      color: #0d3a66;
      margin-bottom: 20px;
      user-select: none;
    }
    form > div {
      margin-bottom: 24px;
    }
    textarea {
      min-height: 100px;
    }
    .submit-btn {
      padding: 16px 36px;
      font-size: 1.15rem;
      border-radius: 14px;
      font-weight: 700;
      user-select: none;
    }
    .confirmation {
      margin-top: 24px;
      font-weight: 600;
      font-size: 1.1rem;
      color: green;
      user-select: none;
    }
    .wizard-progress {
      text-align: center;
      margin-bottom: 20px;
      font-size: 1.1rem;
      color: #1761a0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .progress-bar-container {
      width: 100%;
      background-color: #e0e0e0;
      border-radius: 6px;
      overflow: hidden;
      height: 10px;
      margin-top: 10px;
      display: flex;
    }
    .progress-bar {
      height: 100%;
      background-color: #1761a0;
      transition: width 0.3s ease;
    }
    .step {
      display: none;
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
    }
    .step.active {
      display: block;
      opacity: 1;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 20px;
      background: #fff;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .navigation-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }
    .prev-btn {
      width: 48%;
      background: #6c757d;
    }
    .next-btn, .submit-btn {
      width: 48%;
    }
    .naira-input {
      display: inline;
      position: relative;
      width: 100%;
    }
    .naira-input span.symbol {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      font-weight: 700;
      color: #444;
    }
    .naira-input input {
      padding: 12px 15px 12px 40px;
    }
    .image-preview-container {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .preview-item {
      position: relative;
      width: 100px;
      height: 100px;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .preview-item img, .preview-item video {
      max-width: 100%;
      max-height: 100%;
      object-fit: cover;
    }
    .preview-item .remove-btn {
      position: absolute;
      top: 2px;
      right: 2px;
      background: rgba(255, 0, 0, 0.8);
      color: white;
      border: none;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      cursor: pointer;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .error-message {
      color: #e03e2f;
      font-size: 0.9rem;
      margin-top: 5px;
    }
    /* Wizard-specific styles */
    .wizard-step-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
      color: #1761a0;
      font-size: 1.3rem;
      font-weight: 700;
    }
    .wizard-step-header .material-icons {
      font-size: 28px;
    }

    /* Review Summary Styles */
    #summary {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid #e0e0e0;
    }
    #summary p {
      margin: 10px 0;
      font-size: 1rem;
      line-height: 1.6;
    }
    #summary strong {
      color: #0d3a66;
      display: inline-block;
      min-width: 150px;
    }

    /* Upload Overlay Styles */
    .upload-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 9999;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(5px);
    }
    .upload-overlay.active {
      display: flex;
    }
    .upload-content {
      background: white;
      padding: 40px;
      border-radius: 20px;
      text-align: center;
      max-width: 400px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }
    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #1761a0;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .upload-text {
      font-size: 1.2rem;
      font-weight: 600;
      color: #0d3a66;
      margin-bottom: 10px;
    }
    .upload-subtext {
      font-size: 0.95rem;
      color: #666;
    }
    .upload-progress {
      width: 100%;
      height: 8px;
      background: #e0e0e0;
      border-radius: 4px;
      margin-top: 20px;
      overflow: hidden;
    }
    .upload-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #1761a0, #004080);
      width: 0%;
      transition: width 0.3s ease;
      animation: progressPulse 1.5s ease-in-out infinite;
    }
    @keyframes progressPulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    /* Success Animation */
    .success-checkmark {
      width: 80px;
      height: 80px;
      margin: 0 auto 20px;
    }
    .success-checkmark .check-icon {
      width: 80px;
      height: 80px;
      position: relative;
      border-radius: 50%;
      box-sizing: content-box;
      border: 4px solid #4CAF50;
    }
    .success-checkmark .check-icon::before {
      top: 3px;
      left: -2px;
      width: 30px;
      transform-origin: 100% 50%;
      border-radius: 100px 0 0 100px;
    }
    .success-checkmark .check-icon::after {
      top: 0;
      left: 30px;
      width: 60px;
      transform-origin: 0 50%;
      border-radius: 0 100px 100px 0;
      animation: rotate-circle 4.25s ease-in;
    }
    .success-checkmark .check-icon::before,
    .success-checkmark .check-icon::after {
      content: '';
      height: 100px;
      position: absolute;
      background: #FFFFFF;
      transform: rotate(-45deg);
    }
    .success-checkmark .icon-line {
      height: 5px;
      background-color: #4CAF50;
      display: block;
      border-radius: 2px;
      position: absolute;
      z-index: 10;
    }
    .success-checkmark .icon-line.line-tip {
      top: 46px;
      left: 14px;
      width: 25px;
      transform: rotate(45deg);
      animation: icon-line-tip 0.75s;
    }
    .success-checkmark .icon-line.line-long {
      top: 38px;
      right: 8px;
      width: 47px;
      transform: rotate(-45deg);
      animation: icon-line-long 0.75s;
    }
    @keyframes icon-line-tip {
      0% {
        width: 0;
        left: 1px;
        top: 19px;
      }
      54% {
        width: 0;
        left: 1px;
        top: 19px;
      }
      70% {
        width: 50px;
        left: -8px;
        top: 37px;
      }
      84% {
        width: 17px;
        left: 21px;
        top: 48px;
      }
      100% {
        width: 25px;
        left: 14px;
        top: 45px;
      }
    }
    @keyframes icon-line-long {
      0% {
        width: 0;
        right: 46px;
        top: 54px;
      }
      65% {
        width: 0;
        right: 46px;
        top: 54px;
      }
      84% {
        width: 55px;
        right: 0px;
        top: 35px;
      }
      100% {
        width: 47px;
        right: 8px;
        top: 38px;
      }
    }
  </style>
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <div id="app" role="application">
   <aside class="sidebar" aria-label="Main navigation">
       <nav aria-label="Primary navigation">
          <a href="track-sales.html" tabindex="0" aria-label="Track Sales" >
        <span class="material-icons" aria-hidden="true">assessment</span>DASHBOARD
      </a>

        <a href="index.html"  tabindex="0" aria-current="page" aria-label="Home">
          <span class="material-icons" aria-hidden="true">home</span>Avialable properties
        </a>
        <!--<a href="buy-page.html" tabindex="0" aria-label="Buy Homes">
          <span class="material-icons" aria-hidden="true">support_agent</span>Buy
        </a>
        <a href="rent-page.html" tabindex="0" aria-label="Rent Homes">
          <span class="material-icons" aria-hidden="true">key</span>Rent
        </a>-->
        <a href="sell-page.html" tabindex="0" aria-label="Sell Homes" class="active">
          <span class="material-icons" aria-hidden="true" >sell</span>Sell
        </a>
       <!-- <a href="home-improvemet-page.html" tabindex="0" aria-label="Home Improvement">
          <span class="material-icons" aria-hidden="true">home_repair_service</span>Home Improvement
        </a>
        <a href="message-page.html" tabindex="0" aria-label="Messages">
          <span class="material-icons" aria-hidden="true">message</span>Messages
          
        </a>-->
       

          <% if (isAdmin) { %> <a href="sales-approval.html" tabindex="0" aria-label="Sales Approval">
        <span class="material-icons" aria-hidden="true">check_circle</span>Sales Approval
      </a>
      <!--<a href="tour-requested.html" tabindex="0" aria-label="Tour Requested">
        <span class="material-icons" aria-hidden="true">event_available</span>Tour Requested
      </a>-->
       <a href="manage-agent" tabindex="0" aria-label="View All Customers">
       <span class="material-icons" aria-hidden="true">event_available</span>Manage Agent
      </a>
      <a href="view-customers.html" tabindex="0" aria-label="View All Customers">
        <span class="material-icons" aria-hidden="true">people</span>View All Customers
      </a>
       
    

       <a href="sold-properties" tabindex="0" aria-label="Track Sales" >
        <span class="material-icons" aria-hidden="true">check_circle</span>Sold property
      </a>

       <a href="setting-page.html" tabindex="0" aria-label="Settings">
          <span class="material-icons" aria-hidden="true">settings</span>Settings
        </a>  <% } %>
        


 <!-- <div class="admin-dropdown">
    <button class="dropdown-toggle" aria-expanded="false" aria-controls="admin-menu">
      <span class="material-icons" aria-hidden="true">admin_panel_settings</span>Admin
      <span class="material-icons dropdown-icon">expand_more</span>
    </button>
    <div class="dropdown-menu" id="admin-menu">
      <a href="sales-approval.html" tabindex="0" aria-label="Sales Approval">
        <span class="material-icons" aria-hidden="true">check_circle</span>Sales Approval
      </a>
      <a href="tour-requested.html" tabindex="0" aria-label="Tour Requested">
        <span class="material-icons" aria-hidden="true">event_available</span>Tour Requested
      </a>
      <a href="view-customers.html" tabindex="0" aria-label="View All Customers">
        <span class="material-icons" aria-hidden="true">people</span>View All Customers
      </a>
       
                        <a href="track-sales.html" tabindex="0" aria-label="Track Sales">
                            <span class="material-icons" aria-hidden="true">assessment</span>Track Sales
                        </a>
                   
    </div>
  </div>-->
  
  
      </nav>
      <footer>
        &copy; 2025 G.O AREGBAN REAL ESTATE FIRM. All rights reserved.
      </footer>
    </aside>

    <header role="banner" aria-label="Primary header">
      <div class="header-left">
        <button class="sidebar-toggle-btn material-icons" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="sidebar">menu</button>
        <a href="#" class="logo" aria-label="G.O AREGBAN REAL ESTATE FIRM Home">
          <span class="material-icons" aria-hidden="true">apartment</span>G.O AREGBAN REAL ESTATE FIRM And Consultant
        </a>
        <nav class="primary-nav" role="navigation" aria-label="Primary site navigation">
          <a href="buy-page.html">Buy</a>
          <a href="sell-page.html" class="active">Sell</a>
        </nav>
      </div>
      <div class="header-right">
        <button class="icon-btn" aria-label="Notifications" aria-haspopup="true" aria-expanded="false">
          <a href="notificatin-page.html"><span class="material-icons">notifications</span></a>
        </button>
        <button class="icon-btn" aria-label="User profile menu" aria-haspopup="true" aria-expanded="false">
          <a href="profile-page.html"><span class="material-icons">person</span></a>
        </button>
      </div>
    </header>

    <main class="container" role="main" aria-label="Sell your home wizard">
      <img src="/img/OGA AYO COM CARDXS.jpg" alt="G.O AREGBAN REAL ESTATE FIRM Logo" class="logo" style="width: 120px; height: auto; margin-bottom: 20px;">
      <h1>Sell Your Home</h1>
      <p>If you're ready to sell your home, complete the wizard below and our agents will contact you with a free consultation and valuation.</p>
      
      <div class="wizard-progress" id="progress">
        Step 1 of 5: <span class="material-icons">person</span> Personal Information
        <div class="progress-bar-container">
          <div id="progressBar" class="progress-bar"></div>
        </div>
      </div>
      
      <form id="sell-form" method="POST" action="/upload" enctype="multipart/form-data">
        <div class="step active" id="step1">
          <div class="wizard-step-header"><span class="material-icons">person</span> Step 1: Personal Information</div>
          <div id="form-desc" style="margin-bottom: 20px; color:#666;">* Required fields</div>
          <div>
            <label for="ownerName">Your Full Name *</label>
            <input type="text" id="ownerName" name="ownerName" required autocomplete="name" />
            <div class="error-message" id="errorOwnerName"></div>
          </div>
          <div>
            <label for="ownerEmail">Email Address *</label>
            <input type="email" id="ownerEmail" name="ownerEmail" required autocomplete="email" />
            <div class="error-message" id="errorOwnerEmail"></div>
          </div>
          <div>
            <label for="ownerPhone">Phone Number *</label>
            <input type="tel" id="ownerPhone" name="ownerPhone" required autocomplete="tel" />
            <div class="error-message" id="errorOwnerPhone"></div>
          </div>
        </div>
        
        <div class="step" id="step2">
          <div class="wizard-step-header"><span class="material-icons">home</span> Step 2: Property Details</div>
          <div>
            <label for="propertyAddress">Property Address *</label>
            <input type="text" id="propertyAddress" name="propertyAddress" required placeholder="Street, City, State, ZIP" autocomplete="street-address" />
            <div class="error-message" id="errorPropertyAddress"></div>
          </div>
          <div>
            <label for="bedrooms">Bedrooms *</label>
            <select id="bedrooms" name="bedrooms" required>
              <option value="" disabled selected>Select number</option>
              <option>0</option>
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5+</option>
            </select>
            <div class="error-message" id="errorBedrooms"></div>
          </div>
          <div>
            <label for="bathrooms">Bathrooms *</label>
            <select id="bathrooms" name="bathrooms" required>
              <option value="" disabled selected>Select number</option>
              <option>0</option>
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4+</option>
            </select>
            <div class="error-message" id="errorBathrooms"></div>
          </div>
          <div>
            <label for="sqft">Square Footage *</label>
            <input type="number" id="sqft" name="sqft" min="100" max="100000" required />
            <div class="error-message" id="errorSqft"></div>
          </div>
        </div>
        
        <div class="step" id="step3">
          <div class="wizard-step-header"><span class="material-icons">description</span> Step 3: Property Info</div>
          <div>
            <label for="title">Title *</label>
            <input type="text" id="title" name="title" placeholder="e.g., Beautiful modern home with spacious backyard" required />
            <div class="error-message" id="errorTitle"></div>
          </div>
          <div>
            <label for="description">Description *</label>
            <textarea id="description" name="description" placeholder="Provide a detailed description of the property" required></textarea>
            <div class="error-message" id="errorDescription"></div>
          </div>
          <div>
            <label for="rentSell">Rent/Sell *</label>
            <select id="rentSell" name="rentSell" required>
              <option value="" disabled selected>Rent/Sell</option>
              <option>Rent</option>
              <option>Sell</option>
            </select>
            <div class="error-message" id="errorRentSell"></div>
          </div>
          <div>
            <label for="property-type">Property Type *</label>
            <select id="property-type" name="property_type" required>
              <option value="" disabled selected>Property Type</option>
              <option>Self Contain</option>
              <option>Plots of Land</option>
              <option>Duplex/Bungalow/Storey Building</option>
            </select>
            <div class="error-message" id="errorPropertyType"></div>
          </div>
          <div>
            <label for="amount">Enter Amount in Naira *</label>
            <div class="naira-input">
              <span class="symbol">₦</span>
              <input type="text" id="amount" name="amount" placeholder="Enter amount" autocomplete="off" required />
            </div>
            <div class="error-message" id="errorAmount"></div>
          </div>
        </div>
        
        <div class="step" id="step4">
          <div class="wizard-step-header"><span class="material-icons">upload</span> Step 4: Upload Media</div>
          <div>
            <label for="image">Upload Images *</label>
            <input type="file" id="image" name="image" accept="image/*" required multiple />
            <div id="image-preview" class="image-preview-container"></div>
            <div class="error-message" id="errorImage"></div>
          </div>
          <div>
            <label for="video">Upload Video *</label>
            <input type="file" id="video" name="video" accept="video/*" required multiple />
            <div id="video-preview" class="image-preview-container" style="margin-top: 10px; display: flex; flex-wrap: wrap; gap: 10px;"></div>
            <div class="error-message" id="errorVideo"></div>
          </div>
        </div>
        
        <div class="step" id="step5">
          <div class="wizard-step-header"><span class="material-icons">checklist</span> Step 5: Review & Submit</div>
          <h2 style="color: #0d3a66; margin-bottom: 15px;">Review Your Information</h2>
          <p style="color: #666; margin-bottom: 25px;">Please review the details below before submitting:</p>
          <div id="summary">
            <p><strong>Name:</strong> <span id="summaryOwnerName"></span></p>
            <p><strong>Email:</strong> <span id="summaryOwnerEmail"></span></p>
            <p><strong>Phone:</strong> <span id="summaryOwnerPhone"></span></p>
            <p><strong>Property Address:</strong> <span id="summaryPropertyAddress"></span></p>
            <p><strong>Bedrooms:</strong> <span id="summaryBedrooms"></span></p>
            <p><strong>Bathrooms:</strong> <span id="summaryBathrooms"></span></p>
            <p><strong>Square Footage:</strong> <span id="summarySqft"></span></p>
            <p><strong>Title:</strong> <span id="summaryTitle"></span></p>
            <p><strong>Description:</strong> <span id="summaryDescription"></span></p>
            <p><strong>Rent/Sell:</strong> <span id="summaryRentSell"></span></p>
            <p><strong>Property Type:</strong> <span id="summaryPropertyType"></span></p>
            <p><strong>Amount:</strong> ₦<span id="summaryAmount"></span></p>
            <p><strong>Images:</strong> <span id="summaryImage"></span></p>
            <p><strong>Video:</strong> <span id="summaryVideo"></span></p>
          </div>
        </div>
        
        <!-- Navigation Buttons -->
        <div class="navigation-buttons">
          <button id="prevBtn" class="prev-btn" type="button" style="display: none;">
            <span class="material-icons">arrow_back</span> Previous
          </button>
          <button id="nextBtn" class="next-btn submit-btn" type="button">
            Next <span class="material-icons">arrow_forward</span>
          </button>
        </div>
      </form>
      
      <!-- Confirmation Message (hidden initially) -->
      <div id="confirmation" class="confirmation" style="display: none;">Your home listing has been submitted successfully! Our agents will contact you soon.</div>
    </main>
  </div>

  <!-- Upload Overlay -->
  <div class="upload-overlay" id="uploadOverlay">
    <div class="upload-content">
      <div id="uploadSpinner" class="spinner"></div>
      <div id="uploadSuccess" class="success-checkmark" style="display: none;">
        <div class="check-icon">
          <span class="icon-line line-tip"></span>
          <span class="icon-line line-long"></span>
          <div class="icon-circle"></div>
          <div class="icon-fix"></div>
        </div>
      </div>
      <div class="upload-text" id="uploadText">Uploading Your Property...</div>
      <div class="upload-subtext" id="uploadSubtext">Please wait while we process your listing</div>
      <div class="upload-progress">
        <div class="upload-progress-bar" id="uploadProgressBar"></div>
      </div>
    </div>
  </div>

  <!-- Script for Wizard Functionality -->
  <script>
    const steps = document.querySelectorAll('.step');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progress');
    let currentStep = 0;

    function showStep(stepIndex) {
      console.log('Showing step:', stepIndex);
      steps.forEach((step, index) => {
        step.classList.toggle('active', index === stepIndex);
      });

      const progressPercentage = ((stepIndex + 1) / steps.length) * 100;
      progressBar.style.width = progressPercentage + '%';
      progressText.innerHTML = `Step ${stepIndex + 1} of ${steps.length}: <span class="material-icons">${getStepIcon(stepIndex)}</span> ${getStepLabel(stepIndex)}`;

      document.getElementById('prevBtn').style.display = stepIndex > 0 ? 'block' : 'none';
      const nextBtn = document.getElementById('nextBtn');
      
      if (stepIndex < steps.length - 1) {
        nextBtn.innerHTML = 'Next <span class="material-icons">arrow_forward</span>';
        nextBtn.type = 'button';
      } else {
        nextBtn.innerHTML = '<span class="material-icons">check_circle</span> Submit';
        nextBtn.type = 'button'; // Changed to button to handle submission manually
        // Populate summary when reaching the last step
        populateSummary();
      }
    }

    function getStepIcon(stepIndex) {
      const icons = ['person', 'home', 'description', 'upload', 'checklist'];
      return icons[stepIndex] || 'help';
    }

    function getStepLabel(stepIndex) {
      const labels = ['Personal Information', 'Property Details', 'Property Info', 'Upload Media', 'Review & Submit'];
      return labels[stepIndex] || 'Unknown';
    }

    function populateSummary() {
      document.getElementById('summaryOwnerName').textContent = document.getElementById('ownerName').value || 'N/A';
      document.getElementById('summaryOwnerEmail').textContent = document.getElementById('ownerEmail').value || 'N/A';
      document.getElementById('summaryOwnerPhone').textContent = document.getElementById('ownerPhone').value || 'N/A';
      document.getElementById('summaryPropertyAddress').textContent = document.getElementById('propertyAddress').value || 'N/A';
      document.getElementById('summaryBedrooms').textContent = document.getElementById('bedrooms').value || 'N/A';
      document.getElementById('summaryBathrooms').textContent = document.getElementById('bathrooms').value || 'N/A';
      document.getElementById('summarySqft').textContent = document.getElementById('sqft').value || 'N/A';
      document.getElementById('summaryTitle').textContent = document.getElementById('title').value || 'N/A';
      document.getElementById('summaryDescription').textContent = document.getElementById('description').value || 'N/A';
      document.getElementById('summaryRentSell').textContent = document.getElementById('rentSell').value || 'N/A';
      document.getElementById('summaryPropertyType').textContent = document.getElementById('property-type').value || 'N/A';
      document.getElementById('summaryAmount').textContent = document.getElementById('amount').value || 'N/A';
      
      const imageFiles = document.getElementById('image').files;
      const videoFiles = document.getElementById('video').files;
      document.getElementById('summaryImage').textContent = imageFiles.length > 0 ? `${imageFiles.length} file(s) selected` : 'No files selected';
      document.getElementById('summaryVideo').textContent = videoFiles.length > 0 ? `${videoFiles.length} file(s) selected` : 'No files selected';
    }

    document.getElementById('nextBtn').addEventListener('click', () => {
      console.log('Next button clicked. Current step:', currentStep);
      
      if (currentStep < steps.length - 1) {
        if (validateStep(currentStep)) {
          currentStep++;
          showStep(currentStep);
        } else {
          console.log('Validation failed for step:', currentStep);
          alert('Please fill in all required fields correctly before proceeding.');
        }
      } else {
        // Last step - submit the form
        if (validateStep(currentStep)) {
          submitForm();
        } else {
          alert('Please review all information before submitting.');
        }
      }
    });

    document.getElementById('prevBtn').addEventListener('click', () => {
      console.log('Previous button clicked. Current step:', currentStep);
      if (currentStep > 0) {
        currentStep--;
        showStep(currentStep);
      }
    });

    function validateStep(stepIndex) {
      console.log('Validating step:', stepIndex);
      let isValid = true;
      const requiredFields = steps[stepIndex].querySelectorAll('[required]');
      const stepErrors = [];

      requiredFields.forEach(field => {
        console.log('Checking field:', field.id, 'Value:', field.value);
        const errorId = getErrorId(field.id);
        const errorElement = document.getElementById(errorId);

        if (!errorElement) {
          console.error('Error element not found for field:', field.id, 'Expected ID:', errorId);
          return;
        }

        errorElement.textContent = '';

        if (field.type === 'file') {
          if (field.files.length === 0) {
            errorElement.textContent = 'Please select at least one file.';
            isValid = false;
            stepErrors.push(field.id);
          }
        } else if (field.tagName === 'SELECT') {
          if (!field.value || field.value === field.options[0].value) {
            errorElement.textContent = 'Please select a valid option.';
            isValid = false;
            stepErrors.push(field.id);
          }
        } else if (field.id === 'amount') {
          const value = field.value.trim();
          if (!value) {
            errorElement.textContent = 'This field is required.';
            isValid = false;
            stepErrors.push(field.id);
          } else if (isNaN(value) || parseFloat(value) <= 0) {
            errorElement.textContent = 'Please enter a valid positive number.';
            isValid = false;
            stepErrors.push(field.id);
          }
        } else {
          if (!field.value || !field.value.trim()) {
            errorElement.textContent = 'This field is required.';
            isValid = false;
            stepErrors.push(field.id);
          }
        }
      });

      console.log('Validation result for step', stepIndex, ':', isValid, 'Errors:', stepErrors);
      return isValid;
    }

    function getErrorId(fieldId) {
      return 'error' + fieldId.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join('');
    }

    // Image preview functionality
    document.getElementById('image').addEventListener('change', function(e) {
      const previewContainer = document.getElementById('image-preview');
      previewContainer.innerHTML = '';
      Array.from(e.target.files).forEach((file, index) => {
        if (file.type.startsWith('image/')) {
          const reader = new FileReader();
          reader.onload = function(e) {
            const div = document.createElement('div');
            div.className = 'preview-item';
            const img = document.createElement('img');
            img.src = e.target.result;
            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-btn';
            removeBtn.textContent = '×';
            removeBtn.type = 'button';
            removeBtn.onclick = function() {
              div.remove();
            };
            div.appendChild(img);
            div.appendChild(removeBtn);
            previewContainer.appendChild(div);
          };
          reader.readAsDataURL(file);
        }
      });
    });

    // Video preview functionality
    document.getElementById('video').addEventListener('change', function(e) {
      const previewContainer = document.getElementById('video-preview');
      previewContainer.innerHTML = '';
      Array.from(e.target.files).forEach((file, index) => {
        if (file.type.startsWith('video/')) {
          const reader = new FileReader();
          reader.onload = function(e) {
            const div = document.createElement('div');
            div.className = 'preview-item';
            const video = document.createElement('video');
            video.src = e.target.result;
            video.controls = true;
            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-btn';
            removeBtn.textContent = '×';
            removeBtn.type = 'button';
            removeBtn.onclick = function() {
              div.remove();
            };
            div.appendChild(video);
            div.appendChild(removeBtn);
            previewContainer.appendChild(div);
          };
          reader.readAsDataURL(file);
        }
      });
    });

    function submitForm() {
    const form = document.getElementById('sell-form');
    const formData = new FormData(form);
    const overlay = document.getElementById('uploadOverlay');
    const spinner = document.getElementById('uploadSpinner');
    const success = document.getElementById('uploadSuccess');
    const uploadText = document.getElementById('uploadText');
    const uploadSubtext = document.getElementById('uploadSubtext');
    const uploadProgressBar = document.getElementById('uploadProgressBar');

    // Show upload overlay
    overlay.classList.add('active');
    spinner.style.display = 'block';
    success.style.display = 'none';
    uploadText.textContent = 'Uploading Your Property...';
    uploadSubtext.textContent = 'Please wait while we process your listing';

    // Simulate progress
    let progress = 0;
    const progressInterval = setInterval(() => {
        progress += 10;
        uploadProgressBar.style.width = progress + '%';
        if (progress >= 90) {
            clearInterval(progressInterval);
        }
    }, 200);

    // Submit form via AJAX
    fetch('/upload', {
        method: 'POST',
        body: formData
    })
    .then(response => {
        clearInterval(progressInterval);
        uploadProgressBar.style.width = '100%';
        
        // Check if response is OK
        if (!response.ok) {
            throw new Error(`Server error: ${response.status}`);
        }
        
        // Get content type
        const contentType = response.headers.get('content-type');
        
        // Parse JSON if available, otherwise return success
        if (contentType && contentType.includes('application/json')) {
            return response.json();
        } else {
            return { success: true, message: 'Upload successful' };
        }
    })
    .then(data => {
        console.log('Server response:', data);
        
        // Show success animation
        setTimeout(() => {
            spinner.style.display = 'none';
            success.style.display = 'block';
            uploadText.textContent = 'Upload Successful!';
            uploadSubtext.textContent = data.message || 'Your property listing has been submitted for review';
            
            // Hide overlay after 3 seconds
            setTimeout(() => {
                overlay.classList.remove('active');
                // Show confirmation message
                document.getElementById('confirmation').style.display = 'block';
                form.reset();
                currentStep = 0;
                showStep(currentStep);
                
                // Show popup message
                alert('Your property has been uploaded successfully! It will be reviewed and approved shortly.');
                
                // Optional: redirect to sales approval page
                // window.location.href = '/sales-approved';
            }, 3000);
        }, 500);
    })
    .catch(error => {
        console.error('Error:', error);
        clearInterval(progressInterval);
        spinner.style.display = 'none';
        success.style.display = 'none';
        uploadText.textContent = 'Upload Failed';
        uploadSubtext.textContent = 'Please try again or contact support';
        uploadProgressBar.style.width = '0%';
        
        setTimeout(() => {
            overlay.classList.remove('active');
            alert('There was an error uploading your property. Please try again.');
        }, 2500);
    });
}
    // Initialize first step
    showStep(currentStep);
  </script>
</body>
</html>